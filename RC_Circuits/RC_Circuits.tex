\newif\ifsolutions
\solutionstrue % Show solutions
%\solutionsfalse % Hide solutions

\documentclass{article}
\usepackage{geometry}
\geometry{margin=1in}
\usepackage{tikz}
\usepackage{amssymb}

% fleqn allows setting indent of display math
\usepackage[fleqn]{amsmath}
\setlength{\mathindent}{0pt} % Set indent
% Disable equation numbering (https://tex.stackexchange.com/a/360378)
\makeatletter
\renewcommand\tagform@[1]{}
\makeatother

% Allow Unicode (some, e.g., © and £ at least)
% https://tex.stackexchange.com/questions/370278/is-there-any-reason-to-use-inputenc
\usepackage[utf8]{inputenc}

% Hyperlinks
\usepackage{hyperref}
\hypersetup{colorlinks=true, urlcolor=blue, linkcolor=blue}

% Prevent indentation of paragraphs
\setlength\parindent{0pt}
\setlength{\parskip}{\baselineskip}

% Spacing above/below equations
% https://tex.stackexchange.com/a/69678
\AtBeginDocument{%
 \abovedisplayskip=-\parskip
 \abovedisplayshortskip=-\parskip
 \belowdisplayskip=0pt
 \belowdisplayshortskip=0pt
}

% Allow 3 additional subsection levels
% https://tex.stackexchange.com/a/60212
\usepackage{titlesec}
\setcounter{secnumdepth}{6}
% H4 in HTML
\titleformat{\paragraph}{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
% H5 in HTML
\titleformat{\subparagraph}{\normalfont\normalsize\bfseries}{\thesubparagraph}{1em}{}
\titlespacing*{\subparagraph}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
% H6 in HTML
\titleformat{\subsubparagraph}{\normalfont\normalsize\bfseries}{\thesubsubparagraph}{1em}{}
\titlespacing*{\subsubparagraph}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

% So enumerate at all levels is numbers
% https://tex.stackexchange.com/questions/78842/nested-enumeration-numbering
\renewcommand{\labelenumii}{\arabic{enumii}.}
\renewcommand{\labelenumiii}{\arabic{enumiii}.}
\renewcommand{\labelenumiv}{\arabic{enumiv}.}

\renewcommand{\mbox}{\text}
\newcommand{\ds}[0]{\displaystyle}
\newcommand{\ihat}[0]{\hat{\boldsymbol{\imath}}}
\newcommand{\jhat}[0]{\hat{\boldsymbol{\jmath}}}
\newcommand{\khat}[0]{\hat{\boldsymbol{k}}}
\newcommand{\xhat}[0]{\hat{\mathbf{x}}}
\newcommand{\yhat}[0]{\hat{\mathbf{y}}}
\newcommand{\zhat}[0]{\hat{\mathbf{z}}}
\newcommand{\rhat}[0]{\hat{\mathbf{r}}}
\newcommand{\bfvec}[1]{\vec{\mathbf{#1}}}
\newcommand{\bfcdot}[0]{\boldsymbol{\cdot}}

\usepackage{fancyhdr}
\pagestyle{fancy}
\lhead{RC Circuits}
\rhead{\thepage}
\fancyfoot{}

\begin{document}

\section{Notation and Equations}

\begin{itemize}

  \item We use the the letter ``C" as a label for a capacitor and the units of charge. When used as a label, $C$ is usually written in itallics. Thus

        ``$Q_C= 10 \text{ C}$" means ``the capacitor labeled $C$ has a charge of $10$ Coulombs."

  \item Lower case letters are used for electrical quantities that vary in time. In circuits with only emfs and resistors, currents and voltages are constant, and we used $I$ and $V$. In the circuits considered in this activity, the currents and voltages vary in time, so we use $i(t)$ and $v(t)$.

  \item In this activity, we use the the relationship $i(t)=dq(t)/dt$ between the current $i(t)$ in the wires connected to a capacitor and the charge $q(t)$ on the capacitor.

\end{itemize}

\section{Discharging Capacitor}

If one capacitor with capacitance $C$ is in a circuit with other resistors (and no emfs), the charge on the capacitor changes with time according to

$q(t)=Q_oe^{-t/\tau}$,

where $\tau\equiv RC$, $Q_o$ is the charge on the capacitor at $t=0$, and $R$ is the equivalent resistance. The quantity $\tau$ is called ``RC time constant." The equation for $q(t)$ follows from using Kirchhoff's voltage law, which gives a differential equation, and then solving the differential equation.

\subsection{Problem}

Find $\tau$ for the following two circuits. Use $R=10\text{ k}\Omega$ and $C=1\text{ }\mu\text{F}$.

\input{figures/Discharging_a.tikz}

\ifsolutions
\textbf{Answer}:

    \begin{itemize}

      \item Left: $R_{\text{eq}}=20\text{ k}\Omega$; $\tau = R_{\text{eq}}C = (20\cdot 10^3\text{ }\Omega) \cdot (10^{-6}\text{ F}) = 0.02\text{ s}$

      \item Right: $R_{\text{eq}}=5\text{ k}\Omega$; $\tau=.005\text{ s}$

    \end{itemize}
\else
\vskip 72pt
\fi
\ifsolutions\else
\vskip 72pt
\fi

\newpage

\subsection{Problem}

For the following circuit, find the charge $q$ on the capacitor at $t=2\text{ s}$ if the switch is closed at $t=0$ and the capacitor has an initial charge of $Q_o$ for the following three cases.

\begin{enumerate}

  \item $RC=1\text{ s}\qquad$ $q(2\text{ s})=\fbox{\qquad\phantom M}$

  \item $RC=2\text{ s}\qquad$ $q(2\text{ s})=\fbox{\qquad\phantom M}$

  \item $RC=4\text{ s}\qquad$ $q(2\text{ s})=\fbox{\qquad\phantom M}$

\end{enumerate}

\ifsolutions

\else
\vskip 56.25pt
\fi
\ifsolutions\else
\vskip 56.25pt
\fi

Next, sketch a plot of $q(t)$ from $t=0$ to $t=6\text{ s}$ for each of these three cases. Used a solid, dashed, and dotted line for case 1., 2., and 3., respectively.

\input{figures/Discharging_b.tikz}

\ifsolutions
\textbf{Answer}:

$q(2)=Q_oe^{-2/RC}$, assuming $RC$ has units of seconds. So

    \begin{enumerate}

      \item $q(2)=Q_oe^{-2/1}=Q_o/e^2 \simeq 0.14 Q_o$

      \item $q(2)=Q_oe^{-2/2}=Q_o/e \simeq 0.37 Q_o$

      \item $q(2)=Q_oe^{-2/4}=Q_o/\sqrt{e} \simeq 0.61 Q_o$

    \end{enumerate}

All curves decay exponentially. To plot, start at $Q_o$, and draw an exponentially decaying curve that passes through one of the values above at $t=2$.
\fi

\subsection{Problem}

\input{figures/Discharging_c.tikz}

In the circuit above, the values of $R$ and $C$ are such that $RC=1\text{ s}$.

\begin{enumerate}

  \item If the capacitor has a charge of $10\text{ nC}$ and the switch is closed, how long will it take for the charge on the capacitor to fall to half of this value?

  \item If the capacitor instead had a charge of $20\text{ nC}$ and the switch is closed, how long will it take for the charge on the capacitor to fall to half of this value?

\end{enumerate}

\ifsolutions
\textbf{Answer}:

$q(t)=Q_oe^{-t/\tau}$ and we want $t$ when $q(t)=Q_o/2$, so need to solve 

$Q_o/2=Q_oe^{-t/\tau}\quad$ or $\quad 1/2=e^{-t/\tau}$

Taking the natural log of boths sides, and using $\ln(1/x)=-\ln x$, gives

\begin{equation}
-\ln(2) = \ln e^{-t/\tau} = -\frac{t}{\tau}
\end{equation}

so $t=\tau\ln(2)\simeq 0.70\tau$. The answer does not depend on $Q_o$, so this is the answer for parts 1. and 2.
\else

\newpage
\fi
\ifsolutions\else
\newpage
\fi

\section{Charging a Capacitor}

If a single capacitor is in series with other resistors and a DC voltage source, the charge of the capacitor varies according to 

\begin{equation}
q(t)=Q_f(1-e^{-t/\tau})
\end{equation}

where $\tau\equiv RC$, $R$ is the equivalent resistance, and $Q_f$ is the final charge on the capacitor, that is, the charge on the capacitor as $t\rightarrow\infty$ (it is technically more accurate to say $t\gg \tau$ instead of $t\rightarrow\infty$).

To find $Q_f$, replace the capacitor with an open circuit and use Kirchhoff's voltage law to find the voltage across the capacitor, $V_f$. Then use $Q_f=CV_f$.

\subsection{Example}

Find $q(t)$ for the following circuit, assuming the switch is closed at $t=0$ and the capacitor is initially uncharged.

\input{figures/Charging_a.tikz}

\textbf{Answer}: When the switch is closed, charge builds up on the capacitor. This build--up continues until the charge on the capacitor is such that no current flows in the circuit. If no current flows through the capacitor, the circuit is equivalent to one in which the capacitor is replaced with an open circuit, as shown below. 

\input{figures/Charging_b.tikz}

Kirchhoff's voltage Law gives

$\mathcal{E}-i(t)R-v_C(t)=0$

For large $t$, $i(t)=0$, leaving $v_{C}(t)=\mathcal{E}$. This voltage is for large $t$, so we relabel it as $V_f$. Using $Q_f=CV_f$ gives $Q_f=C\mathcal{E}$, so

\begin{equation}
q(t)=C\mathcal{E}(1-e^{-t/RC})
\end{equation}

Note that the general formula $q(t)=Q_f(1-e^{-t/\tau})$ that applies for all $t$ is derived by solving the differential equation $\mathcal{E}-i(t)R-v_C(t)=0$ using $i(t)=dq(t)/dt$ and $v_C(t)=Cq(t)$.

\ifsolutions

\else

\newpage
\fi
\ifsolutions\else
\newpage
\fi

\subsection{Problem}

For a circuit with any number of capacitors, DC voltage sources, and resistors, finding the equation for $q(t)$ for each capacitor requires solving a system of differential equations, which is not covered in this course. However, you can find the currents and charges on the capacitor after a long time by replacing all capacitors with open circuits and then using KVL.

\input{figures/Charging_c.tikz}

\begin{enumerate}

  \item Find the charge on the capacitor a long time after the switch is closed.

  \item Find the current in the resistor a long time after the switch is closed.

\end{enumerate}

\ifsolutions
\textbf{Answer}

    \begin{enumerate}

      \item $Q_f=\mathcal{E}C$

      \item $i_{Rf}=\mathcal{E}/R$

    \end{enumerate}
\else
\vskip 144pt
\fi
\ifsolutions\else
\vskip 144pt
\fi

\newpage

\section{Charge/Discharge Problem}

\subsection{Part I}

\input{figures/Charge_Discharge_a.tikz}

The switch in the above circuit has been in position $a$ for a long time. At $t = 0$, the switch is moved to position $b$. The values of the circuit elements are $\mathcal{E}= 12\text{ V}$, $C = 10\text{ mF}$, and $R = 20\text{ }\Omega$.

Let $t=0^-$ correspond to the time just before the switch is moved from $a$ to $b$. Let $t=0^+$ correspond to the time just after the switch is moved from $a$ to $b$.

\begin{enumerate}

  \item What is the current through the resistor at $t=0^-$?

        \ifsolutions
        \textbf{Answer}: Zero.
        \else
        \vskip 56.25pt
        \fi
        \ifsolutions\else
        \vskip 56.25pt
        \fi

  \item What is the current through the resistor at $t=0^+$?

        \ifsolutions
        \textbf{Answer}: Immediately after the switch is moved to $b$, the capacitor starts to discharge though the resistor. Kirchhoff's Voltage law states that the voltage across the resistor equals the voltage across the capacitor, $v_C$. By Ohm's law current through the resistor is $i(0^+) = v_C(0^+)/R = 12\text{ V}/20\text{ }\Omega = 0.6\text{ A}$.
        \else
        \vskip 56.25pt
        \fi
        \ifsolutions\else
        \vskip 56.25pt
        \fi

  \item What is the charge on the capacitor at $t=0^-$?

        \ifsolutions
        \textbf{Answer}: $q(0^-) = Cv_C(0^-) = (10 \text{ mF})(12\text{ V}) = 120\text{ mC}$.
        \else
        \vskip 56.25pt
        \fi
        \ifsolutions\else
        \vskip 56.25pt
        \fi

  \item What is the charge on the capacitor at $t=0^+$?

        \ifsolutions
        \textbf{Answer}: $120\text{ mC}$
        \else
        \vskip 56.25pt
        \fi
        \ifsolutions\else
        \vskip 56.25pt
        \fi

  \item What is the charge on the capacitor at $t = 200\text{ ms}$?

        \ifsolutions
        {\bf Answer: } The time constant is $RC= (10\text{ mF}) (20\text{ }\Omega) = 200\text{ ms}$. At $t = 200\text{ ms}$, the capacitor is in the process of discharging. The charge on the capacitor varies according to $q(t)=Q_oe^{-t/RC}$, so

        $q(200\text{ ms}) = Q_0e^{-200\text{ ms}/RC} = 120\text{ mC} \cdot e^{-200\text{ ms}/200\text{ ms}} \simeq120\text{ mC}\cdot 0.37 \simeq 44 \text{ mC}$.
        \else
        \vskip 56.25pt
        \fi
        \ifsolutions\else
        \vskip 56.25pt
        \fi

\end{enumerate}

\newpage

\subsection{Part II}

\input{figures/Charge_Discharge_b.tikz}

The switch in the above circuit has been in position $b$ for a long time. At $t = 0$, the switch is moved to position $a$. The values of the circuit elements are $\mathcal{E}= 12\text{ V}$, $C = 10\text{ mF}$, and $R = 20\text{ }\Omega$.

Let $t=0^-$ correspond to the time just before the switch is moved from $b$ to $a$. Let $t=0^+$ correspond to the time just after the switch is moved from $b$ to $a$.

\begin{enumerate}

  \item What is the current through the resistor at $t=0^-$?

        \ifsolutions
        {\bf Answer: } Since the switch is on position $b$ for a long time, the charge on and voltage across the capacitor is zero. If the voltage across the capacitor is zero, then by Kirchhoff's voltage law, the voltage across the resistor must be zero. So the current through the resistor is zero.
        \else
        \vskip 56.25pt
        \fi
        \ifsolutions\else
        \vskip 56.25pt
        \fi

  \item What is the voltage across the capacitor at $t=0^-$?

        \ifsolutions
        {\bf Answer: } Zero.
        \else
        \vskip 56.25pt
        \fi
        \ifsolutions\else
        \vskip 56.25pt
        \fi

  \item What is the charge on the capacitor at $t=0^-$?

        \ifsolutions
        {\bf Answer: } Zero.
        \else
        \vskip 56.25pt
        \fi
        \ifsolutions\else
        \vskip 56.25pt
        \fi

  \item What is the charge on the capacitor at  $t=0^+$?

        \ifsolutions
        {\bf Answer: } Zero.
        \else
        \vskip 56.25pt
        \fi
        \ifsolutions\else
        \vskip 56.25pt
        \fi

  \item What is the current through the resistor at $t=0^+$?

        \ifsolutions
        {\bf Answer:} Kirchhoff's voltage law at this time is

        $\mathcal{E}-i(0^+)R-v_C(0^+)=0$

        At $t=0^+$ the voltage across the capacitor is zNeero because it is uncharged, so $i(0^+)R=\mathcal{E}$. Thus, $i(0^+) = \mathcal{E}/R = 12\text{ V}/20\text{ }\Omega = 0.6\text{ A}$.
        \else
        \vskip 56.25pt
        \fi
        \ifsolutions\else
        \vskip 56.25pt
        \fi

  \item What is the charge on the capacitor at time $t = 200\text{ ms}$?

        \ifsolutions
        {\bf Answer: } The time constant is $RC=200\text{ ms}$. At $t=200\text{ ms}$, the charge accumulated on the capacitor is:

        \begin{equation}
        q(200\text{ s}) = C\mathcal{E}(1-e^{-(200\text{ s})/RC}) = (10\text{ mF} \cdot 12\text{ V})(1-e^{-200/200})\simeq (120\text{ mV})(0.63)\simeq 75.9\text{ mV}
        \end{equation}
        \else

        \fi
        \ifsolutions\else

        \fi

\end{enumerate}

\end{document}